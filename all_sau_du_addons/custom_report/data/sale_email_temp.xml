<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data noupdate="1">
        <record id="email_template_custom_sale" model="mail.template">
            <field name="name">Sales: Custom Offer Table</field>
            <field name="model_id" ref="sale.model_sale_order"/>
            <field name="subject">{{ object.company_id.name }} - Offer for {{ object.name or 'Sales Order' }}</field>
            <field name="email_from">{{ object.user_id.email_formatted or object.company_id.email_formatted or
                user.email_formatted }}
            </field>
            <field name="partner_to">{{ object.partner_id.id }}</field>
            <field name="lang">{{ object.partner_id.lang }}</field>
            <field name="auto_delete" eval="True"/>
            <field name="body_html" type="html">
                <div style="margin: 0; padding: 0;">
                    <p style="margin: 0; padding: 0; font-size: 13px;">
                        Hello,
                        <br/>
                        <br/>
                        We are pleased to share our commercial offer
                        <strong t-out="object.name or ''">SO0001</strong>
                        <t t-if="object.origin">
                            (Reference: <span t-out="object.origin or ''">REF001</span>)
                        </t>
                        <br/>
                        <br/>
                        Please find the details of the offer below:
                    </p>

                    <table style="width:100%; border-collapse: collapse; font-size: 13px; margin-top: 10px;">
                        <thead>
                            <tr style="background-color: #0047BA; color: white; text-align: left;">
                                <th style="padding: 8px; border: 1px solid #ddd;">Sr. No.</th>
                                <th style="padding: 8px; border: 1px solid #ddd;">Item Code</th>
                                <th style="padding: 8px; border: 1px solid #ddd;">Description</th>
                                <th style="padding: 8px; border: 1px solid #ddd;">Quantity</th>
                                <th style="padding: 8px; border: 1px solid #ddd;">UOM</th>
                                <th style="padding: 8px; border: 1px solid #ddd;">Discount</th>
                                <th style="padding: 8px; border: 1px solid #ddd;">Unit Price</th>
                                <th style="padding: 8px; border: 1px solid #ddd;">Taxes</th>
                                <th style="padding: 8px; border: 1px solid #ddd;">Amount</th>
                            </tr>
                        </thead>
                        <tbody>
                            <t t-set="sr_no" t-value="0"/>
                            <t t-foreach="object.order_line" t-as="line">
                                <t t-set="sr_no" t-value="sr_no + 1"/>
                                <tr>
                                    <td style="padding: 8px; border: 1px solid #ddd;" t-out="sr_no"/>
                                    <td style="padding: 8px; border: 1px solid #ddd;"
                                        t-out="line.sh_line_customer_code or ''"/>
                                    <td style="padding: 8px; border: 1px solid #ddd;"
                                        t-out="line.sh_line_customer_product_name or ''"/>
                                    <td style="padding: 8px; border: 1px solid #ddd;"
                                        t-out="line.product_uom_qty or ''"/>
                                    <td style="padding: 8px; border: 1px solid #ddd;"
                                        t-out="line.product_uom.name or ''"/>
                                    <td style="padding: 8px; border: 1px solid #ddd;" t-out="line.discount or '0.00'"/>
                                    <td style="padding: 8px; border: 1px solid #ddd;"
                                        t-out="format_amount(line.price_unit, object.currency_id)"/>
                                    <td style="padding: 8px; border: 1px solid #ddd;"
                                        t-out="', '.join(tax.name for tax in line.tax_id)"/>
                                    <td style="padding: 8px; border: 1px solid #ddd;"
                                        t-out="format_amount(line.price_total, object.currency_id)"/>
                                </tr>
                            </t>
                        </tbody>
                    </table>

                    <!-- Summary Table at Bottom Right -->
                    <div style="width: 100%; margin-top: 20px;">
                        <div style="float: right; width: 300px; font-size: 13px;">
                            <table style="width: 100%; border-collapse: collapse; border: 1px solid #000;">
                                <tr style="background-color: #0047BA; color: white;">
                                    <td style="padding: 6px; border: 1px solid #000;">Subtotal</td>
                                    <td style="padding: 6px; border: 1px solid #000; text-align: right;"
                                        t-out="format_amount(object.amount_untaxed, object.currency_id)"/>
                                </tr>
                                <tr>
                                    <td style="padding: 6px; border: 1px solid #000;">TAX</td>
                                    <td style="padding: 6px; border: 1px solid #000; text-align: right;"
                                        t-out="format_amount(object.amount_tax, object.currency_id)"/>
                                </tr>
                                <tr style="background-color: #0047BA; color: white; font-weight: bold;">
                                    <td style="padding: 6px; border: 1px solid #000;">Total</td>
                                    <td style="padding: 6px; border: 1px solid #000; text-align: right;"
                                        t-out="format_amount(object.amount_total, object.currency_id)"/>
                                </tr>
                            </table>
                        </div>
                    </div>
                    <div>
                        <p style="margin-top: 40px; font-size: 13px; clear: both;">
                            <t t-if="not is_html_empty(object.user_id.signature)">
                                <br/>
                                <br/>
                                <t t-out="object.user_id.signature or ''"/>
                            </t>
                        </p>

                    </div>


                </div>
            </field>
        </record>
    </data>
</odoo>
