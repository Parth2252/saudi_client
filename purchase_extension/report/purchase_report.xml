<odoo>
    <template id="report_purchaseorder_document" inherit_id="purchase.report_purchaseorder_document">
        <xpath expr="//t[@t-set='address']" position="before">
            <style>
                .po-lines-auto{
                    table-layout: auto !important;
                    width: 100% !important;
                    border-collapse: collapse;
                }
                .po-lines-auto thead th,
                .po-lines-auto tbody td{
                    vertical-align: top;
                    white-space: normal;
                    word-break: break-word;
                }
                .po-num{ white-space: nowrap; text-align: right; }
                .po-center{ text-align: center; }
            </style>
        </xpath>
        <!-- <xpath expr="//t[@t-set='address']" position="before">
            <style>
                table.custom-width-table {
                table-layout: fixed;
                width: 100%;
                }
                th.vendor-product-name, td.vendor-product-name {
                width: 100px !important;
                word-wrap: break-word;
                }
            </style>
        </xpath> -->


        <!-- Manage the address block. -->
        <xpath expr="//t[@t-set='address']" position="replace" />
        <xpath expr="//t[@t-if='o.dest_address_id']" position="replace">
            <div style="border: 2px solid #000; border-radius: 8px; padding: 10px;">
                <div class="row">
                    <!-- Shipping Address -->
                    <div class="col-4">
                        <t t-if="o.dest_address_id">
                            <strong class="d-block" style="font-weight: bold; color: #0066ff;">Shipping address</strong>
                            <div t-field="o.dest_address_id"
                                 t-options='{"widget": "contact", "fields": ["address", "name", "phone"], "no_marker": True, "phone_icons": True}'/>
                        </t>
                        <t t-else="">
                            <strong class="d-block" style="font-weight: bold; color: #0066ff;">Shipping address:</strong>
                            <span t-field="o.picking_type_id.warehouse_id.name"/>
                            <div t-field="o.picking_type_id.warehouse_id.partner_id"
                                 t-options='{"widget": "contact", "fields": ["address", "phone"], "no_marker": True, "phone_icons": True}'/>
                        </t>
                    </div>

                    <!-- Supplier Information -->
                    <div class="col-4">
                        <strong style="font-weight: bold; color: #0066ff; margin-bottom: 6px;">Supplier Information</strong>
                        <div>
                            <span t-esc="o.partner_id.name"/><br/>
                            <t t-if="o.partner_id.street"><span t-esc="o.partner_id.street"/><br/></t>
                            <t t-if="o.partner_id.street2"><span t-esc="o.partner_id.street2"/><br/></t>
                            <div>
                                <span t-if="o.partner_id.city" t-esc="o.partner_id.city"/>
                                <t t-if="o.partner_id.state_id">
                                    <span>, <t t-esc="o.partner_id.state_id.name"/></span>
                                </t>
                                <t t-if="o.partner_id.zip">
                                    <span> - <t t-esc="o.partner_id.zip"/></span>
                                </t>
                            </div>
                            <t t-if="o.partner_id.country_id">
                                <span t-esc="o.partner_id.country_id.name"/>
                            </t>
                            <br/>
                            <span t-esc="o.partner_id.email"/><br/>
                            <span t-esc="o.partner_id.phone"/><br/>
                            <span t-esc="o.partner_id.mobile"/>
                        </div>
                    </div>

                    <!-- Contact Person Information -->
                    <div class="col-4">
                        <t t-set="contact_person" t-value="o.partner_id.child_ids.filtered(lambda c: c.type == 'contact')[:1]"/>
                        <t t-if="contact_person">
                            <strong style="font-weight: bold; color: #0066ff; margin-bottom: 6px;">Contact Person Information</strong>
                            <div t-esc="contact_person.name"/>
                            <div t-esc="contact_person.phone"/>
                            <div t-esc="contact_person.mobile"/>
                            <div t-esc="contact_person.email"/>
                        </t>
                    </div>
                </div>
            </div>
        </xpath>


        <!-- Add class to the table to activate fixed layout -->
        <xpath expr="//table[hasclass('table')]" position="attributes">
            <attribute name="class">table table-sm custom-width-table</attribute>
        </xpath>

        <!-- Added box layout. -->
        <xpath expr="//span[@t-field='o.payment_term_id']" position="after">
            <div class="mt-3">
                <br/>
                <h4 class="mt-3 mb-2">Banking Details</h4>
                <table style="width:100%; border-collapse:collapse; border:1px solid black;" cellspacing="0" cellpadding="0">
                    <tr>
                        <td style="border:1px solid black; padding:5px; width:50%;">
                            <strong>Beneficiary Full Name :</strong>
                            <span t-esc="o.partner_id.beneficiary_full_name"/>
                        </td>
                        <td style="border:1px solid black; padding:5px; width:50%;">
                            <strong>Beneficiary Address :</strong>
                            <span t-esc="o.partner_id.beneficiary_address"/>
                        </td>
                    </tr>
                    <tr>
                        <td style="border:1px solid black; padding:5px;">
                            <strong>Beneficiary Short Name :</strong>
                            <span t-esc="o.partner_id.beneficiary_short_name"/>
                        </td>
                        <td style="border:1px solid black; padding:5px;">
                            <strong>Beneficiary City :</strong>
                            <span t-esc="o.partner_id.beneficiary_city"/>
                        </td>
                    </tr>
                    <tr>
                        <td style="border:1px solid black; padding:5px;">
                            <strong>Account Number :</strong>
                            <span t-esc="o.partner_id.account_number"/>
                        </td>
                        <td style="border:1px solid black; padding:5px;">
                            <strong>Postal Code :</strong>
                            <span t-esc="o.partner_id.postal_code"/>
                        </td>
                    </tr>
                    <tr>
                        <td style="border:1px solid black; padding:5px;">
                            <strong>Bank Name :</strong>
                            <span t-esc="o.partner_id.beneficiary_bank_name"/>
                        </td>
                        <td style="border:1px solid black; padding:5px;">
                            <strong>Beneficiary Country :</strong>
                            <span t-esc="o.partner_id.beneficiary_country.name"/>
                        </td>
                    </tr>
                    <tr>
                        <td style="border:1px solid black; padding:5px;">
                            <strong>Bank City :</strong>
                            <span t-esc="o.partner_id.bank_city"/>
                        </td>
                        <td style="border:1px solid black; padding:5px;">
                            <strong>Beneficiary Currency :</strong>
                            <span t-esc="o.partner_id.beneficiary_currency_id.name"/>
                        </td>
                    </tr>
                    <tr>
                        <td style="border:1px solid black; padding:5px;">
                            <strong>Swift Code :</strong>
                            <span t-esc="o.partner_id.swift_code"/>
                        </td>
                        <td style="border:1px solid black; padding:5px;">
                            <!-- empty cell to keep column structure -->
                        </td>
                    </tr>
                </table>
            </div>
        </xpath>





        <xpath expr="//thead/tr" position="before">
            <t t-set="show_discount" t-value="any([l.discount for l in o.order_line])"/>
        </xpath>

        <xpath expr="//thead/tr" position="replace">
            <tr>
                <th class="text-center">
                    <strong>#<br/>SN
                    </strong>
                </th>
                <th class="text-center">
                    <strong>رقم الصنف<br/>TS CODE
                    </strong>
                </th>
                <th class="text-center">
                    <strong>الوصف<br/>DESCRIPTION
                    </strong>
                </th>
                <th t-if="o.print_vendor_item_code_and_name" class="text-start">
                    <strong>رمز المنتج من البائع<br/>VENDOR ITEM CODE
                    </strong>
                </th>
                <th t-if="o.print_vendor_item_code_and_name" class="text-center vendor-product-name">
                    <strong>اسم المنتج من المورد<br/>VENDOR PRODUCT NAME
                    </strong>
                </th>
                <th class="text-center">
                    <strong>  
                        المنتج<br/>وحدة 
                      <br/>
                        UOM
                    </strong>
                </th>
                <th class="text-center">
                    <strong>الكمية<br/>QTY
                    </strong>
                </th>
                <th class="text-center">
                    <strong>الوحدة<br/>سعر<br/>UNIT<br/>PRICE 
                        <span class="d-block">(Excl. VAT)</span>
                    </strong>
                </th>
                <t t-if="show_discount">
                    <th class="text-center">
                        <strong>الخصم<br/>DISC.
                        </strong>
                    </th>
                </t>
                <t t-if="o.order_line.filtered(lambda l: l.taxes_id)">
                    <th class="text-center">
                        <strong>الضرائب<br/>VAT</strong>
                    </th>
                </t>
                <th class="text-center">
                    <strong>المبلغ<br/>AMOUNT
                    </strong>
                </th>
            </tr>
        </xpath>

        <xpath expr="//t[@t-foreach='o.order_line']" position="replace">
            <t t-set="line_index" t-value="0"/>
            <t t-foreach="o.order_line" t-as="line">
                <tr>
                    <td class="text-center align-middle">
                        <t t-out="line_index + 1"/>
                    </td>
                    <td class="text-center align-middle">
                        <span t-field="line.product_id.default_code"/>
                    </td>
                    <td class="text-center align-middle">
                        <span t-field="line.name"/>
                    </td>
                    <td t-if="o.print_vendor_item_code_and_name" class="text-center align-middle">
                        <span t-esc="line.product_id.seller_ids and line.product_id.seller_ids[0].product_code or ''"/>
                    </td>
                    <td t-if="o.print_vendor_item_code_and_name" class="text-center vendor-product-name align-middle">
                        <span t-esc="line.product_id.seller_ids and line.product_id.seller_ids[0].product_name or ''"/>
                    </td>
                    <td class="text-center align-middle">
                        <span t-field="line.product_id.uom_id.name"/>
                    </td>
                    <td class="text-center align-middle">
                        <span t-field="line.product_qty"/>
                    </td>
                    <td class="text-center align-middle">
                        <span t-field="line.price_unit"/>
                    </td>
                    <t t-if="show_discount">
                        <td class="text-center align-middle">
                            <t t-esc="str(line.discount or 0) + '%'"/>
                        </td>
                    </t>
                    <t t-if="o.order_line.filtered(lambda l: l.taxes_id)">
                        <td class="text-center align-middle">
                            <t t-foreach="line.taxes_id" t-as="tax" t-separator=", ">
                                <t t-esc="tax.amount"/>%
                            </t>
                        </td>
                    </t>
                    <td class="text-center align-middle">
                        <span t-field="line.price_subtotal"/>
                    </td>
                </tr>
                <t t-set="line_index" t-value="line_index + 1"/>
            </t>
        </xpath>

        <!-- Fixed the layout issue. Apply common space between each block. -->
        <xpath expr="//div[@id='informations']" position="replace">
            <div id="informations" class="row mb-4 text-center" style="border: 2px solid #000; border-radius: 8px; padding: 10px;">
                <div t-if="o.user_id" class="col py-2">
                    <strong>المشتري<br/>Buyer</strong>
                    <div t-field="o.user_id"/>
                </div>
                <div t-if="o.incoterm_id" class="col py-2">
                    <strong>شروط الشحن<br/>Incoterm</strong>
                    <div t-field="o.incoterm_id"/>
                </div>
                <div t-if="o.incoterm_location" class="col py-2">
                    <strong>شروط الشحن الموقع<br/>Incoterm Location</strong>
                    <div t-field="o.incoterm_location"/>
                </div>
                <!-- Remove 'your' from 'your order reference' -->
                <div t-if="o.partner_ref" class="col py-2">
                    <strong>مرجع الطلب<br/>Order Reference</strong>
                    <div t-field="o.partner_ref"/>
                </div>
                <div t-if="o.state in ['purchase','done'] and o.date_approve" class="col py-2">
                    <strong>الموعد النهائي للطلب<br/>Order Date:</strong>
                    <p t-field="o.date_approve" t-options="{'date_only': 'true'}" class="m-0"/>
                </div>
                <div t-elif="o.date_order" class="col py-2">
                    <strong>الموعد النهائي للطلب<br/>Order Deadline</strong>
                    <p t-field="o.date_order" t-options="{'date_only': 'true'}" class="m-0"/>
                </div>
                <div t-if="o.date_planned" class="col py-2">
                    <strong>تاريخ الوصول المتوقع<br/>Expected Arrival</strong>
                    <p t-field="o.date_planned" t-options="{'date_only': 'true'}" class="m-0"/>
                </div>
            </div>
        </xpath>



    </template>


    <template id="report_invoice_document_bilingual" inherit_id="account.document_tax_totals_template">
        <xpath expr="//tr[@class='o_subtotal']/td[1]" position="replace">
            <td>
                <span>المبلغ بدون ضريبة<br/>Untaxed Amount
                </span>
            </td>
        </xpath>

        <xpath expr="//tr[@class='o_total']/td[1]" position="replace">
            <td>
                <strong>الإجمالي<br/>Total
                </strong>
            </td>
        </xpath>
    </template>


    <!--    <template id="report_purchaseorder_inherit_force_arabic" inherit_id="purchase.report_purchaseorder">-->
    <!--        <xpath expr="//t[@t-call='purchase.report_purchaseorder_document']" position="replace">-->
    <!--            <t t-call="purchase.report_purchaseorder_document" t-lang="'ar_001'"/>-->

    <!--        </xpath>-->
    <!--    </template>-->

    <!-- Remove the shipping address block from purchase stock. -->
    <template id="remove_shipping_address_stock" inherit_id="purchase_stock.report_purchaseorder_document">
        <xpath expr="//t[@t-else='']" position="replace"/>
    </template>


</odoo>
