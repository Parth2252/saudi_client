<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <template id="report_sticker_and_label_document">
        <t t-call="web.html_container">
            <t t-foreach="docs" t-as="o">
                <t t-call="web.external_layout">
                    <t t-set="doc" t-value="o.with_context(lang=o.partner_id.lang)"/>
                    <t t-set="company" t-value="res_company"/>
                    <!--                <t t-call="sticker_report.custom_header_footer"/>-->
                    <div class="page">
                        <h2 style="color: #0066FF; font-weight: bold; text-align: center; margin-bottom: 10px;">
                            قائمة التعبئة<br/>Packing List
                        </h2>


                        <div class="row" style="margin-bottom: 15px;">
                            <table style="
        width: 100%;
        table-layout: fixed;
        border-collapse: separate;
        border-spacing: 0;
        font-size: 12px;
        border: none;
        border-radius: 10px;
        overflow: hidden;
        background-color: #fff;
        line-height:18px;
        border-right: 1px solid white;">
                                <tr>
                                    <th style="padding: 6px 10px; font-weight: bold; white-space: nowrap; text-align: left;
                           border-top-left-radius: 10px; border-bottom-left-radius: 10px; border: none;color: #0066FF;">
                                        رقم امر الشراء<br/>PO Number
                                    </th>
                                    <th style="padding: 6px 10px; font-weight: bold; white-space: nowrap; text-align: left; border: none; color: #0066FF;">
                                        التاريخ<br/>Delivery Date
                                    </th>
                                    <th style="padding: 6px 10px; font-weight: bold; white-space: nowrap; text-align: left; border: none; color: #0066FF;">
                                        مندوب مبيعات<br/>Salesperson
                                    </th>
                                </tr>
                                <tr>
                                    <td style="padding: 6px 10px; text-align: left; border: none;">
                                        <span t-field="o.porder_ref"/>
                                    </td>
                                    <td style="padding: 6px 10px; text-align: left; border: none;">
                                        <span t-field="o.scheduled_date"/>
                                    </td>
                                    <td style="padding: 6px 10px; text-align: left; border: none;
                           border-top-right-radius: 10px; border-bottom-right-radius: 10px;">
                                        <span t-field="o.user_id.name"/>
                                    </td>
                                </tr>

                            </table>
                        </div>


                        <div style="border-radius: 12px;background: #f8f8ff;padding: 0;margin-bottom: 20px;">
                            <table style="width: 100%; table-layout: fixed; border-collapse: collapse;border:1px solid white;">
                                <tr>
                                    <td style="border:none; padding: 5px;">
                                        <div style="font-weight: bold; color: #0066FF; margin-bottom: 6px; text-align: left;">
                                            <strong>معلومات المرسل<br/>Shipper
                                            </strong>
                                        </div>
                                        <span t-field="o.company_id.name"/>
                                        <br/>
                                        <!--                                        <span t-esc="'%s%s%s%s%s%s' % (-->
                                        <!--                                o.company_id.street or '',-->
                                        <!--                                o.company_id.street2 and ', ' + o.company_id.street2 or '',-->
                                        <!--                                o.company_id.city and ', ' + o.company_id.city or '',-->
                                        <!--                                o.company_id.state_id and ', ' + o.company_id.state_id.name or '',-->
                                        <!--                                o.company_id.zip and ', ' + o.company_id.zip or '',-->
                                        <!--                                o.company_id.country_id and ', ' + o.company_id.country_id.name or ''-->
                                        <!--                                )"/>-->
                                        <span t-esc="'%s%s%s%s' % (
    o.company_id.street or '',
    o.company_id.street2 and ', ' + o.company_id.street2 or '',
    o.company_id.city and ', ' + o.company_id.city or '',
    o.company_id.state_id and ', ' + o.company_id.state_id.name or ''
)"/>
                                        <br/>
                                        <span t-esc="'%s%s' % (
    o.company_id.zip and ', ' + o.company_id.zip or '',
    o.company_id.country_id and ', ' + o.company_id.country_id.name or ''
)"/>

                                        <t t-if="o.company_id.phone">
                                            <br/>Phone:
                                            <span t-esc="o.company_id.phone"/>
                                        </t>
                                        <t t-if="o.company_id.email">
                                            <br/>Email:
                                            <span t-esc="o.company_id.email"/>
                                        </t>
                                    </td>
                                    <td style="border:none; padding: 5px;">
                                        <div style="font-weight: bold; color: #0066FF; margin-bottom: 6px; text-align: left;">
                                            <strong>معلومات المستلم<br/>Consignee
                                            </strong>
                                        </div>
                                        <span t-field="o.partner_id.name"/>
                                        <br/>
                                        <span t-esc="'%s%s%s%s%s%s' % (
                                o.partner_id.street or '',
                                o.partner_id.street2 and ', ' + o.partner_id.street2 or '',
                                o.partner_id.city and ', ' + o.partner_id.city or '',
                                o.partner_id.state_id and ', ' + o.partner_id.state_id.name or '',
                                o.partner_id.zip and ', ' + o.partner_id.zip or '',
                                o.partner_id.country_id and ', ' + o.partner_id.country_id.name or ''
                                )"/>
                                        <t t-if="o.partner_id.phone">
                                            <br/>Phone:
                                            <span t-esc="o.partner_id.phone"/>
                                        </t>
                                        <t t-if="o.partner_id.email">
                                            <br/>Email:
                                            <span t-esc="o.partner_id.email"/>
                                        </t>
                                    </td>
                                    <td style="border:none; padding: 5px;">
                                        <div style="font-weight: bold; color: #0066FF; margin-bottom: 6px; text-align: left;">
                                            <strong>معلومات الاتصال بالمستلم<br/>Receiver Contact
                                            </strong>
                                        </div>
                                        <t t-set="delivery_address"
                                           t-value="o.partner_id.child_ids.filtered(lambda x: x.type == 'delivery')[:1] or o.partner_id.child_ids[:1]"/>
                                        <t t-if="delivery_address">
                                            <span t-field="delivery_address.name"/>
                                            <br/>
                                            <span t-esc="'%s%s%s%s%s%s' % (
                delivery_address.street or '',
                delivery_address.street2 and ', ' + delivery_address.street2 or '',
                delivery_address.city and ', ' + delivery_address.city or '',
                delivery_address.state_id and ', ' + delivery_address.state_id.name or '',
                delivery_address.zip and ', ' + delivery_address.zip or '',
                delivery_address.country_id and ', ' + delivery_address.country_id.name or ''
                )"/>
                                            <t t-if="delivery_address.phone">
                                                <br/>Phone:
                                                <span t-esc="delivery_address.phone"/>
                                            </t>
                                            <t t-if="delivery_address.email">
                                                <br/>Email:
                                                <span t-esc="delivery_address.email"/>
                                            </t>
                                        </t>
                                        <t t-else="">
                                            <span t-field="o.partner_id.name"/>
                                            <br/>
                                            <span t-esc="'%s%s%s%s%s%s' % (
                o.partner_id.street or '',
                o.partner_id.street2 and ', ' + o.partner_id.street2 or '',
                o.partner_id.city and ', ' + o.partner_id.city or '',
                o.partner_id.state_id and ', ' + o.partner_id.state_id.name or '',
                o.partner_id.zip and ', ' + o.partner_id.zip or '',
                o.partner_id.country_id and ', ' + o.partner_id.country_id.name or ''
                )"/>
                                        </t>
                                    </td>
                                </tr>
                            </table>
                        </div>


                        <table style="width:100%; border-collapse: collapse; border: 1px solid white; margin-top:15px;">

                            <thead>
                                <tr style="background-color: #000080; color: white; border: none; font-size: 12px;">
                                    <th style="padding: 5px; text-align: center; width: 5%; border: none; border-right: 1px solid white;">
                                        رقم البند<br/>Line Item
                                    </th>
                                    <th style="padding: 5px; text-align: center; width: 5%; border: none; border-right: 1px solid white;">
                                        رقم الصنف<br/>TS Code
                                    </th>
                                    <!--
                                    <th style="padding: 5px; text-align: center; width: 5%; border: none; border-right: 1px solid white;">
                                        رقم الصنف<br/>Offered Description
                                    </th>
                                    -->
                                    <th style="padding: 5px; text-align: center; width: 10%; border: none; border-right: 1px solid white;">
                                        رقم المنتج<br/>Item Code
                                    </th>
                                    <th style="padding: 5px; text-align: center; width: 30%; border: none; border-right: 1px solid white;">
                                        الوصف<br/>Description
                                    </th>
                                    <th style="padding: 5px; text-align: center; width: 5%; border: none; border-right: 1px solid white;">
                                        رقم الصنف<br/>Offered Description
                                    </th>
                                    <th style="padding: 5px; text-align: center; width: 13%; border: none; border-right: 1px solid white;">
                                        الكمية الإجمالية<br/>Total Qty
                                    </th>
                                    <th style="padding: 5px; text-align: center; width: 5%; border: none; border-right: 1px solid white;">
                                        وحدة القیاس<br/>UOM
                                    </th>
                                    <th style="padding: 5px; text-align: center; width: 6%; border: none; border-right: 1px solid white;">
                                        عدد الصناديق<br/>Box Qty
                                    </th>
                                    <th style="padding: 5px; text-align: center; width: 6%; border: none; border-right: 1px solid white;">
                                        الوزن الإجمالي<br/>Gross Weight
                                    </th>
                                    <th style="padding: 5px; text-align: center; width: 6%; border: none; border-right: 1px solid white;">
                                        عدد الطبلیات<br/>Pallet Qty
                                    </th>
                                    <th style="padding: 5px; text-align: center; width: 14%; border: none;">
                                        ملاحظات<br/>Remarks
                                    </th>
                                </tr>
                            </thead>


                            <tbody style="page-break-inside: always; font-size: 11px;">
                                <t t-set="total_boxes" t-value="0"/>
                                <t t-set="total_weight" t-value="0"/>
                                <t t-set="total_pallets" t-value="0"/>

                                <t t-foreach="o.move_ids_without_package" t-as="line" t-index="line_index">
                                    <t t-set="total_boxes" t-value="total_boxes + (line.boxes_qty or 0)"/>
                                    <t t-set="total_weight" t-value="total_weight + (line.gross_weight or 0)"/>
                                    <t t-set="total_pallets" t-value="total_pallets + (line.pallet_qty or 0)"/>

                                    <tr t-att-style="'background-color: ' + ('#ededed' if line_index % 2 == 0 else 'white')">
                                        <td style="padding: 12px 5px; height: 32px; text-align: center; word-wrap: break-word; max-width: 0;">
                                            <span t-esc="line_index + 1"/>
                                        </td>
                                        <td style="padding: 12px 5px; height: 32px; text-align: center; word-wrap: break-word; max-width: 0;">
                                            <span t-esc="line.ts_code or ''"/>
                                        </td>
                                        <td style="padding: 12px 5px; height: 32px; text-align: center;">
                                            <span t-esc="line.sh_line_customer_code or ''"/>
                                        </td>
                                        <td style="padding: 12px 5px; height: 32px; text-align: left;">
                                            <span t-esc="line.description or ''"/>
                                        </td>
                                        <td style="padding: 12px 5px; height: 32px; text-align: center; word-wrap: break-word; max-width: 0;">
                                            <span t-esc="line.offered_description_id or 'AS SPECIFIED'"/>
                                        </td>
                                        <td style="padding: 12px 5px; height: 32px; text-align: center; word-wrap: break-word; max-width: 0;">
                                            <span t-esc="line.product_uom_qty"/>
                                        </td>
                                        <td style="padding: 12px 5px; height: 32px; text-align: center; word-wrap: break-word; max-width: 0;">
                                            <span t-esc="line.product_uom.name"/>
                                        </td>
                                        <td style="padding: 12px 5px; height: 32px; text-align: center; word-wrap: break-word; max-width: 0;">
                                            <span t-esc="line.boxes_qty or 0"/>
                                        </td>
                                        <td style="padding: 12px 5px; height: 32px; text-align: center; word-wrap: break-word; max-width: 0;">
                                            <span t-esc="line.gross_weight or 0"/>
                                        </td>
                                        <td style="padding: 12px 5px; height: 32px; text-align: center; word-wrap: break-word; max-width: 0;">
                                            <span t-esc="line.pallet_qty or 0"/>
                                        </td>
                                        <td style="padding: 12px 5px; height: 32px; text-align: center; word-wrap: break-word; max-width: 0;">
                                            <span t-esc="line.remark or ''"/>
                                        </td>
                                    </tr>
                                </t>

                                <tr style="background-color: #f2f2f2;">
                                    <td colspan="7" style="border:none; padding: 5px; text-align: center;"></td>
                                    <td style="padding: 12px 5px; height: 32px; text-align: center; word-wrap: break-word; max-width: 0;">
                                        إجمالي الصناديق<br/>Total Boxes
                                    </td>
                                    <td style="padding: 12px 5px; height: 32px; text-align: center; word-wrap: break-word; max-width: 0;">
                                        الوزن الإجمالي (كجم)<br/>Gross Weight (kg)
                                    </td>
                                    <td style="padding: 12px 5px; height: 32px; text-align: center; word-wrap: break-word; max-width: 0;">
                                        إجمالي المنصات<br/>Total Pallets
                                    </td>

                                    <td colspan="1" style="border:none; padding: 5px;"></td>
                                </tr>
                                <tr style="background-color: #ededed; font-weight: bold; border: 1px solid white;">
                                    <td colspan="7" style="padding: 12px 5px; height: 32px; text-align: center; word-wrap: break-word; max-width: 0;"></td>
                                    <td style="padding: 12px 5px; height: 32px; text-align: center; word-wrap: break-word; max-width: 0;">
                                        <span t-esc="total_boxes"/>
                                    </td>
                                    <td style="padding: 12px 5px; height: 32px; text-align: center; word-wrap: break-word; max-width: 0;">
                                        <span t-esc="total_weight"/>
                                    </td>
                                    <td style="padding: 12px 5px; height: 32px; text-align: center; word-wrap: break-word; max-width: 0;">
                                        <span t-esc="total_pallets"/>
                                    </td>
                                    <td colspan="1" style="padding: 12px 5px; height: 32px; text-align: center; word-wrap: break-word; max-width: 0;"></td>
                                </tr>
                            </tbody>
                        </table>

                        <table style="width:100%;border:1px solid white;page-break-inside:avoid;">
                            <tr style="border:none;border-bottom:1px solid grey">
                                <td colspan="2" style="width:70%;border:none;padding:15px;">
                                    <span>Ship Via:</span>
                                </td>
                            </tr>
                            <tr style="border:none;">
                                <td style="width:70%;border:none;padding-left:5px;">
                                    <span>
                                        Issued By:
                                        <t t-esc="o.validated_by_id.name"/>
                                    </span>
                                    <br/>
                                    <span>Signature:</span>
                                    <br/>
                                    <span>Date:</span>
                                </td>
                                <td style="padding: 5px;border:none;">
                                    <span>Checked By:</span>
                                    <br/>
                                    <span>Signature:</span>
                                    <br/>
                                    <span>Date:</span>
                                </td>
                            </tr>
                        </table>
                    </div>
                </t>
            </t>
        </t>
    </template>


    <record id="paperformat_for_packing_list" model="report.paperformat">
        <field name="name">Packing List and Sticker</field>
        <field name="default" eval="False"/>
        <field name="format">A4</field>
        <field name="page_height">0</field>
        <field name="page_width">0</field>
        <field name="orientation">Portrait</field>
        <field name="margin_top">35</field>
        <field name="margin_bottom">25</field>
        <field name="margin_left">3</field>
        <field name="margin_right">3</field>
        <field name="header_line" eval="False"/>
        <field name="header_spacing">35</field>
        <field name="dpi">90</field>
        <field name="css_margins" eval="True"/>
    </record>


    <record id="action_report_sticker_type" model="ir.actions.report">
        <field name="name">Packing List</field>
        <field name="model">stock.picking</field>
        <field name="report_type">qweb-pdf</field>
        <field name="report_name">sale_extension.report_sticker_and_label_document</field>
        <field name="report_file">sale_extension.report_sticker_and_label_document</field>
        <field name="binding_model_id" ref="stock.model_stock_picking"/>
        <field name="binding_type">report</field>
        <field name="paperformat_id" ref="sale_extension.paperformat_for_packing_list"/>
        <field name="print_report_name">'Packing List - %s' % (object.name)</field>
    </record>


</odoo>